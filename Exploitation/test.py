import adn as adn

LONGUEUR_BASE = 10
NOM_FICHIER_BASE = "test1"

print("Question 1\n")
adn.generer_adn(NOM_FICHIER_BASE + ".adn", LONGUEUR_BASE)
with open(NOM_FICHIER_BASE + ".adn", "r", encoding="utf8") as f:
    fichier = f.read()
print("Le fichier ADN", NOM_FICHIER_BASE + ".adn", "vaut", fichier)

print("\nQuestion2-3\n")
nom_fichier_mute, nb_mutations = adn.mutations(NOM_FICHIER_BASE  + ".adn", 0.2, 0.2, 0.2)
with open(nom_fichier_mute, "r", encoding="utf8") as f:
    fichier = f.read()
    longueur = len(fichier)
nouvelle_longueur_attendue = LONGUEUR_BASE + 0 - nb_mutations[1] + nb_mutations[2]
# Pour calculer la longueur attendue, on fait longueur de base, on ajoute 0 car les 
# mutations par remplacemment ne modifie pas la longueur, ensuite on enleve le nombre 
# de mutations supprimées puis on ajote le nombre de mutations inserées
print("La longueur attendu est de", nouvelle_longueur_attendue)
print("Le fichier ADN", nom_fichier_mute, "vaut", 
      fichier, "il est de longueur", longueur)
assert nouvelle_longueur_attendue == longueur, "La longueur attendu n'est pas la même que la longueur réelle"

print("\nQuestion4\n")
# Déclanche le except
try :
    distance = adn.distance_remplacement_chaine(NOM_FICHIER_BASE + ".adn", nom_fichier_mute)
except :
    print("Les fichiers", NOM_FICHIER_BASE + ".adn", "et", nom_fichier_mute, "ne font pas " \
    "la même longueur")
# Mutation seulemment par remplacemment
NOM_FICHIER_REMPLACEMMENT = "test1remplacemment"
adn.generer_adn(NOM_FICHIER_REMPLACEMMENT + ".adn", LONGUEUR_BASE)
with open(NOM_FICHIER_REMPLACEMMENT + ".adn", "r", encoding="utf8") as f:
    fichier = f.read()
nom_fichier_mute_remplacemment, nb_mutations = adn.mutations(NOM_FICHIER_REMPLACEMMENT  + ".adn", 0.4, 0, 0)
try : 
    distance2 = adn.distance_remplacement_chaine(NOM_FICHIER_REMPLACEMMENT + ".adn", nom_fichier_mute_remplacemment)
    with open(NOM_FICHIER_REMPLACEMMENT + ".adn", "r", encoding="utf8") as f:
        fichier = f.read()
    print("fichier base :", fichier)
    with open(nom_fichier_mute_remplacemment, "r", encoding="utf8") as f:
        fichier = f.read()
    print("fichier muté remplacemment :", fichier)
    print("La distance par remplacemment entre", NOM_FICHIER_REMPLACEMMENT + ".adn", "et", nom_fichier_mute, 
          "vaut", distance2)
except :
    print("Les fichiers", NOM_FICHIER_REMPLACEMMENT + ".adn", "et", nom_fichier_mute, "ne font pas " \
    "la même longueur")

print("\nQuestion6\n")
distance_levenshtein = adn.distance_levenshtein(NOM_FICHIER_REMPLACEMMENT + ".adn", nom_fichier_mute_remplacemment)
# La distance par remplacemment et la distance levenshtein doivent être égale, car les longueurs sont les même
try : 
    assert distance2 == distance_levenshtein
    print("La distance par remplacemment et levenshtein sont bien égaux")
except :
    "Erreur"
